@page "/licitacao"
@inject HttpClient Http
@inject NavigationManager NavigationManager;
@inject IPinturaDAO _pinturas
@inject ILicitacaoDAO _licitacoes
@inject ILeilaoDAO _leilao
@using DataLayer


<PageTitle>BelasArtes</PageTitle>

<!-- Fundo -->
<div style="width: 100%; height: 90%; position: absolute; background: white"></div>
<div style="width: 100%; height: 180%; left: 0%; top: 15%; position: absolute; background: rgba(64, 64, 64, 0.72)"></div>


<!-- Cabecalho -->
<img style="width: 5; height: 14%; left: 0%; top: 0.5%; position: absolute" src="logo.png" />
<div style="width: 30%; height: 20%; left: 2%; top: 4%; position: absolute; text-align: center; color: black; font-size: 200%; font-family: Inter; font-weight: 500; word-wrap: break-word">Leilões Belas Artes</div>

<button onclick="window.location.href='/profile'">
<div style="width: 10%; height: 10%; left: 89%; top: 5%; position: absolute; text-align: center; color: black; font-size: 175%; font-family: Inter; font-weight: 100; word-wrap: break-word">Perfil</div>
</button>
<div style="width: 0%; height: 8%; left: 89.5%; top: 3.5%; position: absolute; border: 1px rgb(0, 0, 0) solid"></div>

<button onclick="window.location.href='/leiloes'">
<div style="width: 20%; height: 10%; left: 71%; top: 5%; position: absolute; text-align: center; color: black; font-size: 175%; 
font-family: Inter; font-weight: 100; word-wrap: break-word">Leilões agendados</div>
</button>
<div style="width: 0%; height: 8%; left: 72.5%; top: 3.5%; position: absolute; border: 1px rgb(0, 0, 0) solid"></div>

<button onclick="window.location.href='/leiloes'">
<div style="width: 20%; height: 10%; left: 54%; top: 5%; position: absolute; text-align: center; color: black; font-size: 175%; font-family: Inter; font-weight: 100; word-wrap: break-word">Leilões a decorrer</div>
</button>
<div style="width: 0%; height: 8%; left: 55.5%; top: 3.5%; position: absolute; border: 1px rgb(0, 0, 0) solid"></div>

<button onclick="window.location.href='/'">
<div style="width: 10%; height: 10%; left: 46%; top: 5%; position: absolute; text-align: center; color: black; font-size: 175%; font-family: Inter; font-weight: 100; word-wrap: break-word">Home</div>
</button>
<div style="width: 0%; height: 8%; left: 89.5%; top: 3.5%; position: absolute; border: 1px rgb(0, 0, 0) solid"></div>

<!--Caixa Esquerda-->
<div style="width: 42.5%; height: 87.5%; left: 5%; top: 35%; position: absolute; background: white; border-radius: 59px; border: 5px black solid"></div>
<div style="width: 42.5%; height: 87.5% ; left : 5%; top: 22.5%; position: absolute; text-align: center; color: black; font-size: 
64px; font-family: Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        @($"{pintura.Nome}")
    }else{
        <span>Loading...</span>
    }
</div>


<!--Caixa Direita-->
<div style="width: 42.5%; height: 87.5%; left: 50%; top: 35%; position: absolute; background: #D9D9D9; border-radius: 59px; border: 5px black solid"></div>
<div style="width: 42.5%; height: 87.5%; left: 50%; top: 25%; position: absolute; text-align: center; color: black; font-size: 45px; font-family: Inter; font-weight: 167; word-wrap: break-word">Termina em 00h00m00s</div>

<div style="width: 42.5%; height: 87.5%; left: 40%; top: 39.5%; position: absolute; text-align: center; color: black; font-size: 
27px; font-family: Inter; font-weight: 167; word-wrap: break-word">Licitação atual:</div>
<div style="width: 42.5%; height: 87.5%; left: 40%; top: 44.5%; position: absolute; text-align: center; color: black; font-size: 55px; font-family: Inter; font-weight: 300; word-wrap: break-word">
    @if (licitacao != null){
        @($"{licitacao.Valor} €")
    }else{
        <span>0€</span>
    }</div>

<div style="width: 42.5%; height: 87.5%; left: 58.5%; top: 39.5%; position: absolute; text-align: center; color: black; font-size: 
27px; font-family: Inter; font-weight: 167; word-wrap: break-word">Efetuada por:</div>
<div style="width: 42.5%; height: 87.5%; left: 58.5%; top: 47%; position: absolute; text-align: center; color: black; font-size: 28px; font-family: Inter; font-weight: 400; word-wrap: break-word">
    @if (licitacao != null){
        @($"{licitacao.EmailLicitador}")
    }else{
        <span>Não existe licitador atual.</span>
    }
</div>

<div style="width: 20%; height: 15%; left: 61.5%; top: 65%; position: absolute; background: white"></div>
<div style="width: 20%; height: 15%; left: 54.5%; top: 65%; position: absolute; text-align: center; color: black; font-size: 70px; 
font-family: Inter; font-weight: 167; word-wrap: break-word">€</div>
<input type="text" style="width: 14%; height: 15%; left: 66.5%; top: 65%; position: absolute; background: #ffffff; padding: 5px; border: none; font-size: 20px; font-family: Inter; font-weight: 167; box-sizing: border-box; outline: none;" placeholder="Valor da licitação...">
<div style="width: 20%; height: 15%; left: 58.5%; top: 80%; position: absolute; text-align: center; color: black; font-size: 
23px; font-family: Inter; font-weight: 167; word-wrap: break-word">
    @if (licitacao != null && leilao != null){
            @($"Valor mínimo: {licitacao.Valor * 1.05}€")
        }else{
            @($"Valor mínimo: €") //Falta aqui
        }
</div>

<div style="width: 30%; height: 10%; left: 58.5%; top: 98%; position: absolute; text-align: center; color: black; font-size: 24px; font-family: Inter; font-weight: 167; word-wrap: break-word">
    @if ( pintura!= null){
        @($"{pintura.Peso*2}€ para Portugal, {pintura.Peso*4}€ envio internacional")
    }else{
        <span>Loading...</span>
    }
</div>
<img style="width: 7.5%; height: 15%; left: 52.5%; top: 93%; position: absolute" src="truckLogo.png" />

<button style="width: 17.5%; height: 10%; left: 62.5%; top: 106.5%; position: absolute; background: black; border-radius: 59px; 
border: none; outline: none;">
    <span style="color: white; font-size: 250%; font-family: Inter;">Submeter</span>
</button>



<!--Fundo da pagina-->
<div style="width: 30%; height: 15%; left: 7.5%; top: 130%; position: absolute; color: black; font-size: 25px; font-family: 
Inter; font-weight: 400; word-wrap: break-word">Descrição:</div>
<div style="width: 30%; height: 15%; left: 7.5%; top: 135.5%; position: absolute; color: black; font-size: 20px; font-family: 
Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        @($"{pintura.Descricao}")
    }else{
        <span>Loading...</span>
    }
</div>

<div style="width: 30%; height: 15%; left: 7.5%; top: 145%; position: absolute; color: black; font-size: 25px; font-family: Inter; font-weight: 400; word-wrap: break-word">Dimensão:</div>
<div style="width: 30%; height: 15%; left: 7.5%; top: 150.5%; position: absolute; color: black; font-size: 20px; font-family: 
Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        @($"A: {pintura.Altura}cm x L: {pintura.Largura}cm")
    }else{
        <span>Loading...</span>
    }
</div>

<div style="width: 30%; height: 15%; left: 35%; top: 145%; position: absolute; color: black; font-size: 25px; font-family: 
Inter; font-weight: 400; word-wrap: break-word">Peso:</div>
<div style="width: 30%; height: 15%; left: 35%; top: 150.5%; position: absolute; color: black; font-size: 20px; font-family: 
Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        @($"{pintura.Peso}kg")
    }else{
        <span>Loading...</span>
    }
</div>

<div style="width: 30%; height: 15%; left: 7.5%; top: 160%; position: absolute; color: black; font-size: 25px; font-family: Inter; font-weight: 400; word-wrap: break-word">Autenticidade:</div>
<div style="width: 30%; height: 15%; left: 7.5%; top: 165.5%; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        <span>
            @if (pintura.Original != null){
                @if (pintura.Original == true){
                    @("Original")
                }else{
                    @("Replica")
                }
            }else{
                @("Nao especificado")
            }
        </span>
    }else{
        <span>Loading...</span>
    }
</div>


<div style="width: 30%; height: 15%; left: 35%; top: 160%; position: absolute; color: black; font-size: 25px; font-family: 
Inter; font-weight: 400; word-wrap: break-word">Ano de criação:</div>
<div style="width: 30%; height: 15%; left: 35%; top: 165.5%; position: absolute; color: black; font-size: 20px; font-family: 
Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        @($"{pintura.AnoCriacao}")
    }else{
        <span>Loading...</span>
    }
</div>

<div style="width: 30%; height: 15%; left: 7.5%; top: 175%; position: absolute; color: black; font-size: 25px; font-family: Inter; font-weight: 400; word-wrap: break-word">Movimento artístico:</div>
<div style="width: 30%; height: 15%; left: 7.5%; top: 180.5%; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 167; word-wrap: break-word">
    @if (pintura != null){
        <span>
        @if (pintura.CodMovimentoArtistico==1){
            @("Antiguidade Ocidental e Oriental")
        }else if (pintura.CodMovimentoArtistico==2){
            @("Idade Média")
        }else if (pintura.CodMovimentoArtistico==3){
            @("Renascentista e Barroco")
        }else if (pintura.CodMovimentoArtistico==4){
            @("Moderno")
        }else if (pintura.CodMovimentoArtistico==5){
            @("Contemporâne")
        }else{
             @("Outro")
        }
        </span>
    }else{
        <span>Loading...</span>
    }
</div>

@code {
    private DataLayer.Leilao? leilao {get;set;}
    private DataLayer.Licitacao? licitacao { get; set; }
    private DataLayer.Pintura? pintura { get; set; }


    protected override async Task OnInitializedAsync(){
        try{
            leilao = (await _leilao.GetLeilaoById(4)).FirstOrDefault();// Mudar id
            licitacao = (await _licitacoes.LicitacoesDoLeilaoOrdenadasPorValor(4)).FirstOrDefault();// Mudar id
            pintura = (await _pinturas.GetPinturaById(leilao.CodPintura)).FirstOrDefault(); 
        }catch (Exception ex){
            Console.WriteLine($"Erro ao obter licitação: {ex.Message}");
        }
    }
}